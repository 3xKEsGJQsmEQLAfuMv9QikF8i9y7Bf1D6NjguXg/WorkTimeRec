- [WorkTimeRec](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#worktimerec)
- [動作環境](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E5%8B%95%E4%BD%9C%E7%92%B0%E5%A2%83)
- [インストール](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB)
- [バージョンアップ](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97)
- [アンインストール](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E3%82%A2%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB)
- [使い方](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E4%BD%BF%E3%81%84%E6%96%B9)
  - [基本的な使い方](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E3%81%84%E6%96%B9)
  - [ボタン説明](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E3%83%9C%E3%82%BF%E3%83%B3%E8%AA%AC%E6%98%8E)
  - [作業時間一覧の編集](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E4%BD%9C%E6%A5%AD%E6%99%82%E9%96%93%E4%B8%80%E8%A6%A7%E3%81%AE%E7%B7%A8%E9%9B%86)
  - [設定画面](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E8%A8%AD%E5%AE%9A%E7%94%BB%E9%9D%A2)
  - [作業履歴画面](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E4%BD%9C%E6%A5%AD%E5%B1%A5%E6%AD%B4%E7%94%BB%E9%9D%A2)
  - [作業履歴検索画面](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec/blob/main/README.md#%E4%BD%9C%E6%A5%AD%E5%B1%A5%E6%AD%B4%E6%A4%9C%E7%B4%A2%E7%94%BB%E9%9D%A2)
- [出力ファイル](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec#%E5%87%BA%E5%8A%9B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB)

# 🟦WorkTimeRec

作業時間記録ツール

![image0](https://user-images.githubusercontent.com/99333667/166092177-5605619f-95dc-4fe0-af43-007bd43b829f.png)

# 🟦動作環境

- Windows
- .NET 6

# 🟦インストール

[Download .NET 6.0 (Linux, macOS, and Windows)](https://dotnet.microsoft.com/en-us/download/dotnet/6.0)から
`.NET Desktop Runtime 6.x`の`x64`をダウンロード・インストール。

[Releases](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec/releases)から`WorkTimeRec.zip`をダウンロード。

zipを右クリックし、プロパティを選択、「許可する」（ブロックの解除）のチェックを入れてOKボタンで閉じる。

![プロパティ](https://user-images.githubusercontent.com/99333667/158997528-5b5e8158-f8c1-4416-bae7-45a5e45a139c.png)

zipを展開し、管理者権限不要な任意の場所に配置する。

# 🟦バージョンアップ

[Releases](https://github.com/3xKEsGJQsmEQLAfuMv9QikF8i9y7Bf1D6NjguXg/WorkTimeRec/releases)から`WorkTimeRec.zip`をダウンロード。

zipを右クリックし、プロパティを選択、「許可する」（ブロックの解除）のチェックを入れてOKボタンで閉じる。

zipを展開し、展開ファイルを前回配置場所に上書きコピーする。

# 🟦アンインストール

展開フォルダごと削除する。

# 🟦使い方

## 💠基本的な使い方

`WorkTimeRec.exe`を起動する。

![image1](https://user-images.githubusercontent.com/99333667/166092212-1e26f867-0a21-4375-a8d4-98955388dd16.png)

左のコンボボックスに作業内容を入力し、右の「開始」ボタンを押す。
そうするとボタンが「作業中」の表示になり、下の一覧に作業開始時刻が追加される。

![image2](https://user-images.githubusercontent.com/99333667/166092389-d606069e-5d93-4017-8bd7-1bd6199aeeef.png)

作業が終わったら「作業中」のボタンを押すと、ボタンテキストが「開始」に戻り、下の一覧に作業終了時刻と、かかった時間が設定される。

![image3](https://user-images.githubusercontent.com/99333667/166092401-8d63380f-be85-43a1-8fae-6fc47b1bd206.png)

作業Aを作業中に（作業Aを終了させずに）作業Bを開始すると、作業Aの作業中が自動解除され、作業Bが作業中になる（作業Aを終えて作業Bに着手したとみなされる）。

並行して複数の作業をする場合は、「並行作業をする」チェックをONにする。
そうすると複数作業中状態にできる（チェックOFFの場合は1度に1つしか作業中にできない）。
タイトルバーに表示される数字は作業中の数。

![image4](https://user-images.githubusercontent.com/99333667/166092414-235db7fd-fd4e-43df-8361-4d31bf85346d.png)

作業コンボボックスは上から順に`Ctrl`+`1` ～ `Ctrl`+`5`のショートカットキーでフォーカス移動できる。
また、`Ctrl`+`↑`, `Ctrl`+`↓`のショートカットキーで上または下にフォーカス移動できる。

開始/作業中ボタンは上から順に`Ctrl`+`Shift`+`1` ～ `Ctrl`+`Shift`+`5`のショートカットキーで押すことができる。
作業コンボボックス上でEnterキーでも可。

## 💠ボタン説明

| ボタン名     | 説明                                                         |
| ------------ | ------------------------------------------------------------ |
| 設定         | 設定画面を表示する。ショートカットキーは`Ctrl`+`,`。         |
| ログフォルダ | 作業時間ログが出力されるフォルダをエクスプローラーで開く。ショートカットキーは`Ctrl`+`L`。 |
| 作業履歴     | 作業コンボボックスの履歴、作業時間のグラフを一覧表示する画面を表示する。ショートカットキーは`Ctrl`+`H`。 |
| 作業クリア   | すべての作業コンボボックスのテキスト入力部分をクリアする。   |
| 作業終了     | 作業中状態を一括終了させる。ショートカットキーは`Esc`。        |
| 閉じる       | アプリケーションを終了する。                                 |

## 💠作業時間一覧の編集

作業中の項目がないときに作業時間一覧で行を選択し、右クリックでマージ、削除、ログファイルに出力して一覧クリアができる。

**マージ**は2つ以上選択状態にして実行する。同じ作業内容 かつ 終了時間から次の開始時間までの間が2分以内のときに1つにまとめることができる。
複数選択は1つ目の行をクリックし、2つ目以降は`Ctrl`を押しながらクリックする。連続した範囲を一括で選択する場合は、範囲の開始行をクリック後、終了行を`Shift`を押しながらクリックする。

![image7](https://user-images.githubusercontent.com/99333667/166092261-ef6fe210-666a-4465-8121-2255c49faf64.png)

![image8](https://user-images.githubusercontent.com/99333667/166092267-70123477-46e0-48fe-af6a-1bcb1b2d1d36.png)

**削除**は1つ以上選択状態にして実行する。選択した項目が一覧から削除される。ログに残したくない項目を削除するときに使用する。

**ログに保存して一覧クリア**は、一覧の内容をすべてログに出力し、一覧の項目をすべて削除する。通常、ログへの出力はアプリケーション終了時に行われるが、このコマンドで任意のタイミングでログ出力できる。

## 💠設定画面

![image5](https://user-images.githubusercontent.com/99333667/166092469-b394d6b8-6afe-429b-ab40-aff2008af2e2.png)

### 作業中のタスクバーアイコン

作業中状態のときのタスクバーアイコンの表示の仕方。「進捗固定」はプログレスバーMAX値固定表示。「アニメーション」はプログレスバーアニメーション。

「進捗固定」選択時はタスクバーの進捗色を設定可能。

#### Windows 10

![win10taskbar](https://user-images.githubusercontent.com/99333667/160762997-dfd98fc0-019c-4580-8f9f-66873862968c.png)

#### Windows 11

![win11taskbar](https://user-images.githubusercontent.com/99333667/160763043-0d44110d-82fb-4cde-a2a2-855e8738b723.png)

### 作業中のコンボボックス

作業中状態のときの作業コンボボックスの表示の仕方。「色付け」はコンボボックスの色を変える。「アニメーション」はコンボボックスにプログレスバー表示。

### 指定時刻にメッセージ表示

指定時刻にメッセージを表示する。チェックボックスをONにすると有効化。
⏱ボタンは入力補助。

#### 「時」入力補助
押したボタンの数値がテキストボックスに入力される。
現在時のボタンは背景色が他と変わる。

![image5_2](https://user-images.githubusercontent.com/99333667/166092279-ab1ac611-8bd2-40e2-99a5-bd4c2ac342e5.png)

#### 「分」入力補助
押したボタンの数値がテキストボックスに入力される。

![image5_3](https://user-images.githubusercontent.com/99333667/166092308-a4b74907-6535-49c3-87fa-4254804b99cd.png)

#### メッセージ表示時、システムサウンドを鳴らす

チェックをONにするとメッセージ表示時に音がでる。

#### 表示メッセージ例
![image9](https://user-images.githubusercontent.com/99333667/166092340-9bfaa81b-e883-44d7-ba6e-e67ee4d171c2.png)

### 起動時、作業コンボボックスに直近の作業内容を設定

チェックONにすると起動時にコンボボックス履歴の先頭項目をコンボボックステキストに設定。チェックOFFだと起動時はコンボボックステキストが空。

### 「並行作業をする」のチェック状態を次回起動時も維持

チェックONにすると次回起動時に「並行作業をする」のチェック状態が復元される。チェックOFFにすると、起動時の「並行作業をする」のチェック初期値はOFF。

### 「作業クリア」ボタンの実行前に確認

チェックONにすると「作業クリア」ボタンを押したときに実行確認をするようになる。

### 「作業終了」ボタンの実行前に確認

チェックONにすると「作業終了」ボタンを押したときに実行確認をするようになる。チェックOFFは「作業終了」ボタンを押したら即座に終了処理を実行する。

### 古い作業時間ログ削除、古い作業項目削除

「古い作業時間ログ削除」は、作業時間ログファイルを直近30日分を残して削除する。

「古い作業項目削除」は、5つの作業コンボボックスの履歴をそれぞれ直近40件分を残して削除する。

ごみ箱の数はログの溜まり具合。

![image5_4](https://user-images.githubusercontent.com/99333667/166092512-04d2879a-a690-493a-8a64-b9e92ab8fcaf.png)

## 💠作業履歴画面

画面下部のボタンで作業項目一覧と作業時間グラフを切り替え表示する。
5つのリストは`Ctrl`+`1`～`Ctrl`+`5`のショートカットで移動可能。

### 「作業項目」選択時

全ての作業コンボボックスの履歴を一覧表示する。
また、一覧の項目をダブルクリックするか`Enter`キーで、その項目をコンボボックスのテキストエリアに入力する。

![image6](https://user-images.githubusercontent.com/99333667/166093120-706d99b7-3816-4836-b487-6b334831dee0.png)

### 「作業時間グラフ」選択時

今日と、（ログファイルの存在する）直近4日間の作業時間を棒グラフで表示する。
今日の分はログファイルとメイン画面の作業時間一覧に表示されているものの合算。
グラフは対象日の中で一番作業時間が長い項目を最大値とした割合。

![image6_2](https://user-images.githubusercontent.com/99333667/166093130-26759c0b-7b57-46ee-a785-8eec19187ac9.png)

## 💠作業履歴検索画面

作業履歴画面で作業履歴検索ボタンを押すか、メイン画面か作業履歴画面でショートカットキー`Ctrl`+`F`で表示する。

検索ボックスにキーワードを入力して`Enter`か検索ボタンを押すと作業時間ログをファイル検索し、一致する行を表示する。

![image6_3](https://user-images.githubusercontent.com/99333667/166093150-fc50a30f-fa03-42ff-9649-b9f438708b43.png)

![image6_4](https://user-images.githubusercontent.com/99333667/166093158-3ca98d28-d03b-4e4e-bb38-d8c651131625.png)

# 🟦出力ファイル

作業内容のコンボボックスに入力したものは、「開始」ボタンを押したタイミングで`WorkTimeRec.exe`と同じ場所に`WorkList1.txt`～`WorkList5.txt`というファイル名で出力/更新され、
次回アプリケーション起動時にコンボボックスの選択肢として読み込まれる。

作業時間一覧情報は、アプリ終了時に`WorkTimeRec.exe`と同じ場所に`Record`という名前でフォルダを作成し、
その中に`yyyymmdd.log`のファイル名フォーマットのログに追記される。
ファイル内容はタブ区切り形式。

